<?xml version="1.0" encoding="utf-8"?>
<DS xmlns="http://www.eprosima.com/XMLSchemas/discovery-server" user_shutdown="false">

    <servers>
        <server name="server" profile_name="UDP server" />
    </servers>

    <!--
        Separate tests to probe every possibility in disposals
        PDP is probed from one step to the other

        time 0: start new test / creation
        time 6: original snapshot
        time 8: create / remove entities
        time 14: result snapshot
        time 16: remove all

    -->

    <clients>
        <!-- standar test 
                1.P1 - 2.S1 --> 
        <client removal_time="16" name="client1_server1" profile_name="UDP_client1_server1">
            <publisher topic="topic1"/>
        </client>
        <client removal_time="16" name="client2_server1" profile_name="UDP_client2_server1">
            <subscriber topic="topic1"/>
        </client>

        <!-- test remove publisher
                1.P1 - 2.S1 : 1 - 2.S1 --> 
        <client creation_time="20" removal_time="36" name="client3_server1" profile_name="UDP_client3_server1">
            <publisher removal_time="28" topic="topic1"/>
        </client>
        <client creation_time="20" removal_time="36" name="client4_server1" profile_name="UDP_client4_server1">
            <subscriber topic="topic1"/>
        </client> 

        <!-- test remove subscriber
                1.P1 - 2.S1 : 1.P1 - 2 --> 
        <client creation_time="40" removal_time="56" name="client5_server1" profile_name="UDP_client5_server1">
            <publisher topic="topic1"/>
        </client>
        <client creation_time="40" removal_time="56" name="client6_server1" profile_name="UDP_client6_server1">
            <subscriber removal_time="48" topic="topic1"/>
        </client>     

        <!-- test remove repeated
                1.[P1.P2] - 2.[S1.S2] : 1.P2 - 2.S2 -->
        <client creation_time="60" removal_time="76" name="client7_server1" profile_name="UDP_client7_server1">
            <publisher removal_time="68" topic="topic1"/>
            <publisher topic="topic1"/>
        </client>
        <client creation_time="60" removal_time="76" name="client8_server1" profile_name="UDP_client8_server1">
            <subscriber removal_time="68" topic="topic1"/>
            <subscriber topic="topic1"/>
        </client>  

        <!-- test remove both one after another
                1.P1 - 2.S1 : 1 - 2 -->
        <client creation_time="80" removal_time="96" name="client9_server1" profile_name="UDP_client9_server1">
            <publisher removal_time="88" topic="topic1"/>
        </client>
        <client creation_time="80" removal_time="96" name="client10_server1" profile_name="UDP_client10_server1">
            <subscriber removal_time="88" topic="topic1"/>
        </client>

        <!-- test remove then create twice
                1.S1 - 2.P1 : 1 - 2.P1 - 3.S1 : 2 - 3.S1 - 4.P1 -->
        <client creation_time="100" removal_time="116" name="client11_server1" profile_name="UDP_client11_server1">
            <subscriber removal_time="108" topic="topic1"/>
        </client>
        <client creation_time="100" removal_time="136" name="client12_server1" profile_name="UDP_client12_server1">
            <publisher removal_time="116" topic="topic1"/>
        </client>
        <client creation_time="110" removal_time="136" name="client13_server1" profile_name="UDP_client13_server1">
            <subscriber topic="topic1"/>
        </client>
        <client creation_time="120" removal_time="136" name="client14_server1" profile_name="UDP_client14_server1">
            <publisher topic="topic1"/>
        </client> 

        
    </clients>

    <snapshots file="./test_disposals_edp.snapshot~">

        <snapshot time="14">test_disposals_2.P1_-_3.S1</snapshot>

        <snapshot time="26">test_disposals_4.P1_-_5.S1</snapshot>
        <snapshot time="34">test_disposals_4_-_5.S1</snapshot>

        <snapshot time="46">test_disposals_6.P1_-_7.S1</snapshot>
        <snapshot time="54">test_disposals_6.P1_-_7</snapshot>

        <snapshot time="66">test_disposals_8.[P1,P2]_-_9.[S1,S2]</snapshot>
        <snapshot time="74">test_disposals_8.P2_-_9.S2</snapshot>

        <snapshot time="86">test_disposals_a.P1_-_b.S1</snapshot>
        <snapshot time="94">test_disposals_a_-_b</snapshot>

        <snapshot time="106">test_disposals_c.S1_-_d.P1</snapshot>
        <snapshot time="114">test_disposals_c_-_d.P1_-_e.S1</snapshot>
        <snapshot time="126">test_disposals_d_-_e.S1_-_f.P1</snapshot>
        
        <snapshot time="140">test_disposals_closure</snapshot>
        
    </snapshots>

    <profiles>
        <participant profile_name="UDP_client1_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.31.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client2_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.32.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client3_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.33.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client4_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.34.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client5_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.35.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client6_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.36.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client7_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.37.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client8_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.38.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client9_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.39.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client10_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.40.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client11_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.41.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client12_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.42.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client13_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.43.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_client14_server1" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.44.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                                <metatrafficUnicastLocatorList>
                                    <locator>
                                        <udpv4>
                                            <address>127.0.0.1</address>
                                            <port>11811</port>
                                        </udpv4>
                                    </locator>
                                </metatrafficUnicastLocatorList>
                            </RemoteServer>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP server">
        <rtps>
            <prefix>44.49.53.43.53.45.52.56.45.52.5F.31</prefix>
            <builtin>
                <discovery_config>
                    <discoveryProtocol>SERVER</discoveryProtocol>
                    <initialAnnouncements>
                        <count>0</count>
                    </initialAnnouncements>
                    <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                    <leaseDuration>DURATION_INFINITY</leaseDuration>
                </discovery_config>
                <metatrafficUnicastLocatorList>
                    <locator>
                        <udpv4>
                            <address>127.0.0.1</address>
                            <port>11811</port>
                        </udpv4>
                    </locator>
                </metatrafficUnicastLocatorList>
            </builtin>
        </rtps>
        </participant>

        <topic profile_name="topic1">
            <name>topic_1</name>
            <dataType>sample_type_1</dataType>
        </topic>

        <types>
            <type>
              <struct name="sample_type_1">
                <member name="index" type="uint32" />
                <member name="message" type="string" />
              </struct>
            </type>
        </types>

     </profiles>
</DS>