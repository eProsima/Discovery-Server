<?xml version="1.0" encoding="utf-8"?>
<DS xmlns="http://www.eprosima.com/XMLSchemas/discovery-server" user_shutdown="false">

    <servers>
        <server name="server1" prefix="44.49.53.43.53.45.52.56.45.52.5f.30" profile_name="UDP server"/>
        <server name="server2" prefix="44.49.53.43.53.45.52.56.45.52.5f.31" profile_name="UDP server">
            <ListeningPorts>
                <metatrafficUnicastLocatorList>
                    <locator>
                        <udpv4>
                            <address>127.0.0.1</address>
                            <port>11812</port>
                        </udpv4>
                    </locator>
                </metatrafficUnicastLocatorList>
            </ListeningPorts>
            <ServersList>
                <RServer prefix="44.49.53.43.53.45.52.56.45.52.5F.30" />
            </ServersList>    
        </server>
        <server name="server3" prefix="44.49.53.43.53.45.52.56.45.52.5f.32" profile_name="UDP server">          
            <ListeningPorts>
                <metatrafficUnicastLocatorList>
                    <locator>
                        <udpv4>
                            <address>127.0.0.1</address>
                            <port>11813</port>
                        </udpv4>
                    </locator>
                </metatrafficUnicastLocatorList>
            </ListeningPorts>
            <ServersList>
                <RServer prefix="44.49.53.43.53.45.52.56.45.52.5F.30" />
            </ServersList>    
        </server>
        <server name="server4" prefix="44.49.53.43.53.45.52.56.45.52.5f.33" profile_name="UDP server">          
            <ListeningPorts>
                <metatrafficUnicastLocatorList>
                    <locator>
                        <udpv4>
                            <address>127.0.0.1</address>
                            <port>11814</port>
                        </udpv4>
                    </locator>
                </metatrafficUnicastLocatorList>
            </ListeningPorts>
            <ServersList>
                <RServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31" />
                <RServer prefix="44.49.53.43.53.45.52.56.45.52.5F.32" />
            </ServersList>
        </server>
    </servers>

    <clients>
        <client name="client1" profile_name="UDP client">
            <publisher topic="topic1"/>
        </client>
        <client name="client2" profile_name="UDP client2">
            <subscriber topic="topic2"/>
        </client>
        <client name="client3" profile_name="UDP client3">
            <subscriber topic="topic1"/>
        </client>
        <client name="client42" profile_name="UDP client4">
            <publisher topic="topic2"/>
        </client>
    </clients>

    <snapshots file="./test_diamond_servers.snapshot~">
        <snapshot time="15">4 servers in diamond, each with one client with topics in opposite client</snapshot>
    </snapshots>

    <profiles>
        <participant profile_name="UDP client" >
        <rtps>
            <builtin>
                <discovery_config>
                    <discoveryProtocol>CLIENT</discoveryProtocol>
                    <discoveryServersList>
                        <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.30">
                            <metatrafficUnicastLocatorList>
                                <locator>
                                    <udpv4>
                                        <address>127.0.0.1</address>
                                        <port>11811</port>
                                    </udpv4>
                                </locator>
                            </metatrafficUnicastLocatorList>
                        </RemoteServer>
                    </discoveryServersList>
                    <initialAnnouncements>
                        <count>0</count>
                    </initialAnnouncements>
                    <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                    <leaseDuration>DURATION_INFINITY</leaseDuration>
                </discovery_config>
            </builtin>
        </rtps>
        </participant>

        <participant profile_name="UDP client2" >
        <rtps>
            <builtin>
                <discovery_config>
                    <discoveryProtocol>CLIENT</discoveryProtocol>
                    <discoveryServersList>
                        <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.31">
                            <metatrafficUnicastLocatorList>
                                <locator>
                                    <udpv4>
                                        <address>127.0.0.1</address>
                                        <port>11812</port>
                                    </udpv4>
                                </locator>
                            </metatrafficUnicastLocatorList>
                        </RemoteServer>
                    </discoveryServersList>
                    <initialAnnouncements>
                        <count>0</count>
                    </initialAnnouncements>
                    <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                    <leaseDuration>DURATION_INFINITY</leaseDuration>
                </discovery_config>
            </builtin>
        </rtps>
        </participant>

        <participant profile_name="UDP client3" >
        <rtps>
            <builtin>
                <discovery_config>
                    <discoveryProtocol>CLIENT</discoveryProtocol>
                    <discoveryServersList>
                        <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.32">
                            <metatrafficUnicastLocatorList>
                                <locator>
                                    <udpv4>
                                        <address>127.0.0.1</address>
                                        <port>11813</port>
                                    </udpv4>
                                </locator>
                            </metatrafficUnicastLocatorList>
                        </RemoteServer>
                    </discoveryServersList>
                    <initialAnnouncements>
                        <count>0</count>
                    </initialAnnouncements>
                    <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                    <leaseDuration>DURATION_INFINITY</leaseDuration>
                </discovery_config>
            </builtin>
        </rtps>
        </participant>

        <participant profile_name="UDP client4" >
        <rtps>
            <builtin>
                <discovery_config>
                    <discoveryProtocol>CLIENT</discoveryProtocol>
                    <discoveryServersList>
                        <RemoteServer prefix="44.49.53.43.53.45.52.56.45.52.5F.33">
                            <metatrafficUnicastLocatorList>
                                <locator>
                                    <udpv4>
                                        <address>127.0.0.1</address>
                                        <port>11814</port>
                                    </udpv4>
                                </locator>
                            </metatrafficUnicastLocatorList>
                        </RemoteServer>
                    </discoveryServersList>
                    <initialAnnouncements>
                        <count>0</count>
                    </initialAnnouncements>
                    <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                    <leaseDuration>DURATION_INFINITY</leaseDuration>
                </discovery_config>
            </builtin>
        </rtps>
        </participant>

        <participant profile_name="UDP server">
        <rtps>
            <prefix>44.49.53.43.53.45.52.56.45.52.5F.30</prefix>
            <builtin>
                <discovery_config>
                    <discoveryProtocol>SERVER</discoveryProtocol>
                    <initialAnnouncements>
                        <count>0</count>
                    </initialAnnouncements>
                    <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                    <leaseDuration>DURATION_INFINITY</leaseDuration>
                </discovery_config>
                <metatrafficUnicastLocatorList>
                    <locator>
                        <udpv4>
                            <address>127.0.0.1</address>
                            <port>11811</port>
                        </udpv4>
                    </locator>
                </metatrafficUnicastLocatorList>
            </builtin>
        </rtps>
        </participant>

        <topic profile_name="topic1">
            <name>topic_1</name>
            <dataType>sample_type_1</dataType>
        </topic>

        <topic profile_name="topic2">
            <name>topic_2</name>
            <dataType>sample_type_1</dataType>
        </topic>
        
        <types>
            <type>
              <struct name="sample_type_1">
                <member name="index" type="uint32" />
                <member name="message" type="string" />
              </struct>
            </type>
        </types>

     </profiles>
</DS>
