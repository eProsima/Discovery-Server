<?xml version="1.0" encoding="utf-8"?>
<DS xmlns="http://www.eprosima.com/XMLSchemas/discovery-server" user_shutdown="false">

    <!--
        In this test the client is configured to not use initial announcements and have infinite lease period
        announcement. This will result in no communication with the server until the client event is triggered.
        In the first trigger, the client will announce its PDP. In the second trigger, the client will announce
        its EDP. This will result in S1 knowing C1's participant at second 5 and its endpoints at second 10.
        S2 will not know C1 until second 10, because S1 does not resend C1's PDP until it matches its endpoints
        and the dirty topics are processed.
    -->

    <servers>
        <server name="server1" prefix="44.49.53.43.53.45.52.56.45.52.5F.31" profile_name="UDP_server1" />
        <server name="server2" prefix="44.49.53.43.53.45.52.56.45.52.5F.32" profile_name="UDP_server2" creation_time="7"/>
    </servers>

    <clients>
        <client name="client1" profile_name="UDP_client">
            <publisher topic="topic1"/>
        </client>
    </clients>

    <snapshots file="./test_30_connect_locally_with_remote_entity.snapshot~">
        <snapshot time="9">S1 knows C1 PDP. S2 only knows S1</snapshot>
        <snapshot time="12">All knows each other</snapshot>
    </snapshots>

    <profiles>
        <participant profile_name="UDP_client" >
            <rtps>
                <prefix>63.6c.69.65.6e.74.31.5f.73.31.5f.5f</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>CLIENT</discoveryProtocol>
                        <discoveryServersList>
                            <locator>
                                <udpv4>
                                    <address>127.0.0.1</address>
                                    <port>04811</port>
                                </udpv4>
                            </locator>
                            <locator>
                                <udpv4>
                                    <address>127.0.0.1</address>
                                    <port>04812</port>
                                </udpv4>
                            </locator>
                        </discoveryServersList>
                        <initialAnnouncements>
                            <count>0</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>DURATION_INFINITY</leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                        <clientAnnouncementPeriod>
                            <sec>5</sec>
                        </clientAnnouncementPeriod>
                    </discovery_config>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_server1">
            <rtps>
                <prefix>44.49.53.43.53.45.52.56.45.52.5F.31</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryProtocol>SERVER</discoveryProtocol>
                        <initialAnnouncements>
                            <count>5</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>
                            <nanosec>500000000</nanosec>
                        </leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                    <metatrafficUnicastLocatorList>
                        <locator>
                            <udpv4>
                                <address>127.0.0.1</address>
                                <port>04811</port>
                            </udpv4>
                        </locator>
                    </metatrafficUnicastLocatorList>
                </builtin>
            </rtps>
        </participant>

        <participant profile_name="UDP_server2">
            <rtps>
                <prefix>44.49.53.43.53.45.52.56.45.52.5F.32</prefix>
                <builtin>
                    <discovery_config>
                        <discoveryServersList>
                            <locator>
                                <udpv4>
                                    <address>127.0.0.1</address>
                                    <port>04811</port>
                                </udpv4>
                            </locator>
                        </discoveryServersList>
                        <discoveryProtocol>SERVER</discoveryProtocol>
                        <initialAnnouncements>
                            <count>5</count>
                        </initialAnnouncements>
                        <leaseAnnouncement>
                            <nanosec>500000000</nanosec>
                        </leaseAnnouncement>
                        <leaseDuration>DURATION_INFINITY</leaseDuration>
                    </discovery_config>
                    <metatrafficUnicastLocatorList>
                        <locator>
                            <udpv4>
                                <address>127.0.0.1</address>
                                <port>04812</port>
                            </udpv4>
                        </locator>
                    </metatrafficUnicastLocatorList>
                </builtin>
            </rtps>
        </participant>

        <topic profile_name="topic1">
            <name>topic_1</name>
            <dataType>HelloWorld</dataType>
        </topic>

     </profiles>
</DS>
